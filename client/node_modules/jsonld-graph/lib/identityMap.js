"use strict";
var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
Object.defineProperty(exports, "__esModule", { value: true });
const shortid_1 = __importDefault(require("shortid"));
const constants_1 = require("./constants");
/**
 * @description Node identity map that keeps a map of blank node ids to unique node ids.
 * @export
 * @class IdentityMap
 */
class IdentityMap {
    constructor() {
        this._map = new Map();
    }
    /**
     * @description Gets the mapped id for a node.
     * @param {*} node
     * @returns {string}
     * @memberof IdentityMap
     */
    get(node) {
        if (!node) {
            return null;
        }
        const nodeId = node[constants_1.JsonldKeywords.id];
        if (!nodeId || !nodeId.startsWith(constants_1.BlankNodePrefix)) {
            return nodeId;
        }
        if (this._map.has(nodeId)) {
            return this._map.get(nodeId);
        }
        const newNodeId = `${constants_1.BlankNodePrefix}-${shortid_1.default()}`;
        this._map.set(nodeId, newNodeId);
        return newNodeId;
    }
}
exports.IdentityMap = IdentityMap;
exports.default = IdentityMap;
//# sourceMappingURL=identityMap.js.map