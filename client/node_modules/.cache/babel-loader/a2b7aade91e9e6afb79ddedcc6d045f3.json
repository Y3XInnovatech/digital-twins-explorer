{"ast":null,"code":"// Copyright (c) Microsoft Corporation.\n// Licensed under the MIT license.\n\nimport { eventService } from \"./EventService\";\nimport { storageService } from \"./StorageService\";\nconst StorageKeyName = \"configuration\";\nclass ConfigService {\n  constructor() {\n    const initConfig = async () => {\n      this._config = await this.getConfig();\n    };\n    initConfig();\n  }\n  setConfig(config) {\n    this._config = config;\n    storageService.setLocalStorageObject(StorageKeyName, config);\n    eventService.publishClearCache();\n  }\n  getConfig() {\n    if (this._config) {\n      return Promise.resolve(this._config);\n    }\n    const localStorageConfig = storageService.getLocalStorageObject(StorageKeyName);\n    if (localStorageConfig) {\n      return Promise.resolve(localStorageConfig);\n    }\n    return new Promise((resolve, reject) => {\n      const callback = evt => {\n        if (evt.type === \"end\") {\n          eventService.unsubscribeConfigure(callback);\n          if (evt.config) {\n            this.setConfig(evt.config);\n            resolve(evt.config);\n          } else {\n            const e = new Error(\"Configuration aborted\");\n            e.errorCode = \"user_cancelled\";\n            reject(e);\n          }\n        }\n      };\n      eventService.subscribeConfigure(callback);\n      eventService.publishConfigure({\n        type: \"start\"\n      });\n    });\n  }\n}\nexport const configService = new ConfigService();","map":{"version":3,"names":["eventService","storageService","StorageKeyName","ConfigService","constructor","initConfig","_config","getConfig","setConfig","config","setLocalStorageObject","publishClearCache","Promise","resolve","localStorageConfig","getLocalStorageObject","reject","callback","evt","type","unsubscribeConfigure","e","Error","errorCode","subscribeConfigure","publishConfigure","configService"],"sources":["/home/saharsh/Music/digital-twins-explorer/client/src/services/ConfigService.js"],"sourcesContent":["// Copyright (c) Microsoft Corporation.\n// Licensed under the MIT license.\n\nimport { eventService } from \"./EventService\";\nimport { storageService } from \"./StorageService\";\n\nconst StorageKeyName = \"configuration\";\n\nclass ConfigService {\n\n  constructor() {\n    const initConfig = async () => {\n      this._config = await this.getConfig();\n    };\n    initConfig();\n  }\n\n  setConfig(config) {\n    this._config = config;\n    storageService.setLocalStorageObject(StorageKeyName, config);\n    eventService.publishClearCache();\n  }\n\n  getConfig() {\n    if (this._config) {\n      return Promise.resolve(this._config);\n    }\n\n    const localStorageConfig = storageService.getLocalStorageObject(StorageKeyName);\n    if (localStorageConfig) {\n      return Promise.resolve(localStorageConfig);\n    }\n\n    return new Promise((resolve, reject) => {\n      const callback = evt => {\n        if (evt.type === \"end\") {\n          eventService.unsubscribeConfigure(callback);\n          if (evt.config) {\n            this.setConfig(evt.config);\n            resolve(evt.config);\n          } else {\n            const e = new Error(\"Configuration aborted\");\n            e.errorCode = \"user_cancelled\";\n            reject(e);\n          }\n        }\n      };\n\n      eventService.subscribeConfigure(callback);\n      eventService.publishConfigure({ type: \"start\" });\n    });\n  }\n\n}\n\nexport const configService = new ConfigService();\n"],"mappings":"AAAA;AACA;;AAEA,SAASA,YAAY,QAAQ,gBAAgB;AAC7C,SAASC,cAAc,QAAQ,kBAAkB;AAEjD,MAAMC,cAAc,GAAG,eAAe;AAEtC,MAAMC,aAAa,CAAC;EAElBC,WAAWA,CAAA,EAAG;IACZ,MAAMC,UAAU,GAAG,MAAAA,CAAA,KAAY;MAC7B,IAAI,CAACC,OAAO,GAAG,MAAM,IAAI,CAACC,SAAS,CAAC,CAAC;IACvC,CAAC;IACDF,UAAU,CAAC,CAAC;EACd;EAEAG,SAASA,CAACC,MAAM,EAAE;IAChB,IAAI,CAACH,OAAO,GAAGG,MAAM;IACrBR,cAAc,CAACS,qBAAqB,CAACR,cAAc,EAAEO,MAAM,CAAC;IAC5DT,YAAY,CAACW,iBAAiB,CAAC,CAAC;EAClC;EAEAJ,SAASA,CAAA,EAAG;IACV,IAAI,IAAI,CAACD,OAAO,EAAE;MAChB,OAAOM,OAAO,CAACC,OAAO,CAAC,IAAI,CAACP,OAAO,CAAC;IACtC;IAEA,MAAMQ,kBAAkB,GAAGb,cAAc,CAACc,qBAAqB,CAACb,cAAc,CAAC;IAC/E,IAAIY,kBAAkB,EAAE;MACtB,OAAOF,OAAO,CAACC,OAAO,CAACC,kBAAkB,CAAC;IAC5C;IAEA,OAAO,IAAIF,OAAO,CAAC,CAACC,OAAO,EAAEG,MAAM,KAAK;MACtC,MAAMC,QAAQ,GAAGC,GAAG,IAAI;QACtB,IAAIA,GAAG,CAACC,IAAI,KAAK,KAAK,EAAE;UACtBnB,YAAY,CAACoB,oBAAoB,CAACH,QAAQ,CAAC;UAC3C,IAAIC,GAAG,CAACT,MAAM,EAAE;YACd,IAAI,CAACD,SAAS,CAACU,GAAG,CAACT,MAAM,CAAC;YAC1BI,OAAO,CAACK,GAAG,CAACT,MAAM,CAAC;UACrB,CAAC,MAAM;YACL,MAAMY,CAAC,GAAG,IAAIC,KAAK,CAAC,uBAAuB,CAAC;YAC5CD,CAAC,CAACE,SAAS,GAAG,gBAAgB;YAC9BP,MAAM,CAACK,CAAC,CAAC;UACX;QACF;MACF,CAAC;MAEDrB,YAAY,CAACwB,kBAAkB,CAACP,QAAQ,CAAC;MACzCjB,YAAY,CAACyB,gBAAgB,CAAC;QAAEN,IAAI,EAAE;MAAQ,CAAC,CAAC;IAClD,CAAC,CAAC;EACJ;AAEF;AAEA,OAAO,MAAMO,aAAa,GAAG,IAAIvB,aAAa,CAAC,CAAC","ignoreList":[]},"metadata":{},"sourceType":"module"}